class Terrain{constructor(a){this.$element=a,this.hauteur=0,this.largeur=0,this.calculeTailles()}calculeTailles(){this.hauteur=this.$element.height(),this.largeur=this.$element.width()}affichePause(){this.$element.addClass("pause")}affichePlay(){this.$element.removeClass("pause")}}class Balle{constructor(a){this.$element=a,this.x=this.$element.position().left,this.y=this.$element.position().top,this.diametre=this.$element.width(),this.direction=1,this.vitesseX=0,this.vitesseY=0,this.vitesseDepart=terrain.largeur/500,this.vitesseMax=0,this.acceleration=0,this.calculeTailles()}calculeTailles(){this.vitesseMax=terrain.largeur/100,this.acceleration=terrain.largeur/1e3}accelere(){this.vitesseX<this.vitesseMax?this.vitesseX+=this.acceleration:this.vitesseX=this.vitesseMax}devieDirection(a){let b=(this.y-(a.y+a.hauteur/2))/(a.hauteur/2);this.vitesseY+=.75*b}bouge(){this.y+=this.vitesseY,this.x+=this.vitesseX*this.direction,this.limiteMouvements(),this.rafraichitHTML()}limiteMouvements(){(0>this.y||this.y+this.diametre>terrain.hauteur)&&(this.vitesseY*=-1,this.y+=this.vitesseY,audio.playNote()),(this.toucheJoueur1()||this.toucheJoueur2())&&(this.toucheJoueur1()&&(joueur1.effetToucheBalle(),this.devieDirection(joueur1)),this.toucheJoueur2()&&(joueur2.effetToucheBalle(),this.devieDirection(joueur2)),this.direction*=-1,this.x+=this.vitesseX*this.direction,this.accelere()),this.toucheCoteGauche()&&joueur2.gagne(),this.toucheCoteDroite()&&joueur1.gagne()}toucheJoueur1(){return!!(this.x<joueur1.x+joueur1.largeur&&this.y+this.diametre>joueur1.y&&this.y<joueur1.y+joueur1.hauteur)}toucheJoueur2(){return!!(this.x+this.diametre>joueur2.x&&this.y+this.diametre>joueur2.y&&this.y<joueur2.y+joueur2.hauteur)}toucheCoteGauche(){return!!(0>this.x)}toucheCoteDroite(){return this.x+this.diametre>terrain.largeur}rafraichitHTML(){this.$element.css("top",this.y),this.$element.css("left",this.x)}}class Joueur{constructor(a,b){this.$raquette=a,this.$score=b,this.score=0,this.y=0,this.x=0,this.hauteur=0,this.largeur=0,this.vitesse=3,this.adversaire=null,this.monte=!1,this.descend=!1,this.calculeTailles()}calculeTailles(){this.hauteur=this.$raquette.height(),this.largeur=this.$raquette.width(),this.y=parseInt(this.$raquette.css("top")),this.x=parseInt(this.$raquette.css("left"))}incrementeScore(a){this.score+=a,this.effetScore(),this.$score.text(this.score)}limiteMouvements(){let a=terrain.hauteur-this.hauteur;this.y<0&&(this.y=0),this.y>a&&(this.y=a)}rafraichitHTML(){this.$raquette.css("top",this.y)}bouge(){this.descend?this.y+=this.vitesse:this.monte&&(this.y-=this.vitesse),this.limiteMouvements(),this.rafraichitHTML()}effetToucheBalle(){this.effetCss(this.$raquette,"touche-balle"),audio.playNote()}effetScore(){this.effetCss(this.$score,"flash")}effetCss(a,b){a.addClass(b),setTimeout(()=>{a.removeClass(b)},100)}gagne(){this.incrementeScore(10),this.rafraichitHTML(),audio.fausseNote(),partie.demarreNouveauJeu()}}class Audio{constructor(){createjs.Sound.registerSound("sound/do.mp3","do"),createjs.Sound.registerSound("sound/re.mp3","re"),createjs.Sound.registerSound("sound/mi.mp3","mi"),createjs.Sound.registerSound("sound/fa.mp3","fa"),createjs.Sound.registerSound("sound/sol.mp3","sol"),createjs.Sound.registerSound("sound/la.mp3","la"),createjs.Sound.registerSound("sound/si.mp3","si")}playNote(){let a=["do","re","mi","fa","sol","la","si"],b=a[Math.floor(Math.random()*a.length)];createjs.Sound.play(b)}fausseNote(){this.playNote(),this.playNote(),this.playNote(),this.playNote(),this.playNote()}}class Controles{constructor(){this.$monte1=$("#monte1"),this.$descend1=$("#descend1"),this.$monte2=$("#monte2"),this.$descend2=$("#descend2");let a=this;window.addEventListener("keydown",function(b){if(!b.defaultPrevented){switch(b.key){case"a":a.monte1(!0);break;case"q":a.descend1(!0);break;case"p":a.monte2(!0);break;case"m":a.descend2(!0);}b.preventDefault()}},!0),window.addEventListener("keyup",function(b){if(!b.defaultPrevented){switch(b.key){case"a":a.monte1(!1);break;case"q":a.descend1(!1);break;case"p":a.monte2(!1);break;case"m":a.descend2(!1);}b.preventDefault()}},!0),this.$monte1.on("mousedown touchstart",function(b){b.preventDefault(),a.monte1(!0)}),this.$monte1.on("mouseup touchend",function(b){b.preventDefault(),a.monte1(!1)}),this.$monte2.on("mousedown touchstart",function(b){b.preventDefault(),a.monte2(!0)}),this.$monte2.on("mouseup touchend",function(b){b.preventDefault(),a.monte2(!1)}),this.$descend1.on("mousedown touchstart",function(b){b.preventDefault(),a.descend1(!0)}),this.$descend1.on("mouseup touchend",function(b){b.preventDefault(),a.descend1(!1)}),this.$descend2.on("mousedown touchstart",function(b){b.preventDefault(),a.descend2(!0)}),this.$descend2.on("mouseup touchend",function(b){b.preventDefault(),a.descend2(!1)}),$body[0].addEventListener("touchmove",function(a){console.log(a)},!1)}monte1(a){a?this.$monte1.addClass("active"):this.$monte1.removeClass("active"),joueur1.monte=a}monte2(a){a?this.$monte2.addClass("active"):this.$monte2.removeClass("active"),joueur2.monte=a}descend1(a){a?this.$descend1.addClass("active"):this.$descend1.removeClass("active"),joueur1.descend=a}descend2(a){a?this.$descend2.addClass("active"):this.$descend2.removeClass("active"),joueur2.descend=a}}class Partie{constructor(){let a=this;this.paused=!0,this.$ecranDebut=$(".ecran-debut"),this.$btnGo=$(".btn-go"),this.$btnGo.click(function(){a.demarreNouveauJeu(),$body[0].requestFullscreen()}),setInterval(()=>{joueur1.bouge(),joueur2.bouge(),a.paused||balle.bouge()},10),setInterval(function(){terrain.calculeTailles(),joueur1.calculeTailles(),joueur2.calculeTailles(),balle.calculeTailles()},3e3)}demarreNouveauJeu(){this.$ecranDebut.addClass("invisible"),this.paused=!0,terrain.affichePause();let a=this;setTimeout(function(){terrain.affichePlay(),a.paused=!1,balle.x=terrain.largeur/2,balle.y=terrain.hauteur/2,balle.vitesseX=balle.vitesseDepart,balle.vitesseY=Math.random()*balle.vitesseDepart,.5<Math.random()&&(balle.vitesseY*=-1),.5<Math.random()&&(balle.direction*=-1)},3e3)}}let $body=$("body"),$terrain=$(".terrain"),terrain=new Terrain($terrain),$balle=$(".balle"),balle=new Balle($balle),$joueur1=$(".joueur1"),$score1=$(".score1"),joueur1=new Joueur($joueur1,$score1),$joueur2=$(".joueur2"),$score2=$(".score2"),joueur2=new Joueur($joueur2,$score2);joueur1.adversaire=joueur2,joueur2.adversaire=joueur1;let controles=new Controles,audio=new Audio,partie=new Partie;